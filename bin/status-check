#!/usr/bin/env node

var commander = require('commander'),
    package = require('../package.json'),
    client = require('socket.io-client').connect('http://127.0.0.1:4322');

client.on('status', function (status) {
    if (status.length == 0) {
        console.log('Calibrating ...');
    } else {
        status.forEach(function (instance) {
            console.log(instance.id + ': ' + instance.status);
        });
    }
    client.close();
});

commander.version(package.version)
    .option('-l, --list', 'Lists the status of all the observed containers')
    .parse(process.argv);


if (commander.list) {
    client.emit('status');
}

